<escPressed>

<script src="key-emit.js" type="text/javascript"></script>

    <script type="text/javascript">
    var listen = false;
        // key_emit is a global added by the key-emit.js include ^
        var k = key_emit(document);
        /*
        k.pressed.on("escape", function(){
            console.log("You pressed ESC!");
           // var xhr = new XMLHttpRequest();
           // xhr.open("POST", '/startlisten', true);
           // xhr.setRequestHeader('Content-Type', 'application/json');
           // xhr.send();
            xhr.send(JSON.stringify({
            value: value
            }));
        });
        */
       
        k.down.on("escape", function() {
            console.log("escape is DOWN");
            //post('/startlisten');
            if (listen){
                var xhr = new XMLHttpRequest();
                xhr.open("POST", '/listenonoff', true);
                xhr.setRequestHeader('Content-Type', 'application/json');
                //xhr.send();
                xhr.send(JSON.stringify({
                    text: 'false'
                }));
            } else {
                var xhr = new XMLHttpRequest();
                xhr.open("POST", '/listenonoff', true);
                xhr.setRequestHeader('Content-Type', 'application/json');
                //xhr.send();
                xhr.send(JSON.stringify({
                    text: 'true'
                }));
            }
             
        })
        k.up.on("escape", function() {
            console.log("escape is UP");
        })


        /*k.down.on("any_key", function(key) {
            console.log("you just pressed: " + key)
        })*/
    </script>
</escPressed>